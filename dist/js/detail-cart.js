!function(){var c=getCookie("userId")||0;globalCart={getQuantity:function(o){var c=$.extend({success:function(){}},o);0===yb.isLogin?function(){var o=$.parseJSON(localStorage.getItem("cart")),e=0;if(o){for(var t in o)o[t].goodsNum&&(e+=o[t].goodsNum);c.success(e)}else c.success(0)}():yb.isLogin},add:function(o){var e,t=$.extend({goodsCode:null,goodsNum:1,salePrice:null,extendValue:null,success:null},o);if(!t.goodsCode||Number(t.salePrice<=0))return!1;0===yb.isLogin?((e=$.parseJSON(localStorage.getItem("cart"))||{})[t.goodsCode]?e[t.goodsCode].goodsNum?e[t.goodsCode].goodsNum+=t.goodsNum:e[t.goodsCode].goodsNum=t.goodsNum:(e[t.goodsCode]={},e[t.goodsCode].goodsNum=t.goodsNum),t.salePrice&&(e[t.goodsCode].salePrice=t.salePrice),localStorage.setItem("cart",JSON.stringify(e)),t.success({error:0,message:"ok"})):1===yb.isLogin&&(console.log("进入了登录状态的加入购物车"),$.ajax({type:"get",url:"api/dmAddToCart.php",dataType:"json",data:{goodsCode:t.goodsCode,userId:c,goodsNum:t.goodsNum},success:function(o){o.error||t.success(o)}}))}},cart=function(){$(".detail_footer .icon-d-goodscart").length&&globalCart.getQuantity({success:function(o){0<o?($(".detail_footer .icon-d-goodscart i").text(o),$(".detail_footer .icon-d-goodscart i").addClass("red")):$(".detail_footer .icon-d-goodscart i").hide()}});detailJS.eject($(".js_cart").eq(1),".choice_content-a_ico,.tc_bg",".tc_container_choice"),$(".js_cart").eq(1).on("click",function(){console.log(detailJS.eject)}),$(".js_cart").eq(0).on("click",function(){var o,t,c,s;o=$(".choice_content-a_title_bian").attr("data-index"),t=Number($("#count").val()),c=Number($(".wbPrice").text()),s=$(".detail_footer .icon-d-goodscart i"),globalCart.add({goodsCode:o,goodsNum:t,salePrice:c,success:function(o){$(".detail_footer .icon-d-goodscart i").show(),1===yb.isLogin?o&&(0<o.error?console.log(e.info.message||"网络异常"):($(".coice_content_cont_num").text(t),s.text(Number(s.eq(0).text())+t))):0===yb.isLogin&&($(".coice_content_cont_num").text(t),s.text(Number(s.eq(0).text())+t))}}),$(".tc_content").removeClass("tc_bottom"),$("body").css({overflow:"auto"}),$(".tc_container_choice").fadeOut()})}()}();