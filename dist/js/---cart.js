wb.extend(window.mui,{wCloseAllToasts:function(){$(".mui-toast-container.mui-active").trigger("click")}}),Handlebars.registerHelper("WB_GetImagesUrl",function(t,o,e){return/^(http|https)/.test(t)?t:"//"+o+"/"+t}),Handlebars.registerHelper("HBS_equal",function(t,o,e){return t!=o?e.inverse(this):e.fn(this)}),Handlebars.registerHelper("HBS_lessThanOrEqual",function(t,o,e){if("number"==typeof t&&"number"==typeof o)return t<=o?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("HBS_lessThan",function(t,o,e){if("number"==typeof t&&"number"==typeof o)return t<o?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("HBS_largerThan",function(t,o,e){if("number"==typeof t&&"number"==typeof o)return o<t?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("HBS_price",function(t){return 3<t.toString().length?t=parseInt(t).toLocaleString():t}),function(t,i){function o(){this.editAll=function(){for(var t in i(".shop-blocks").addClass("editing"),wb.cart.scrolls)wb.cart.scrolls[t].scrollTo(0,0,200,IScroll.utils.ease.quadratic);setTimeout(function(){wb.cart.scrolls[t].enabled=!1},210)},this.editAllCancel=function(){for(var t in i(".shop-blocks").removeClass("editing"),wb.cart.scrolls)wb.cart.scrolls[t].enabled=!0},this.isShopSelectedAll=function(t){var o=i(".shop-blocks[data-shop-code="+t+"]");return o.find(".goods .cart-tik.on").length===o.find(".goods .cart-tik").length},this.isSelectedAll=function(){return i(".shop-blocks .cart-tik.on").length===i(".shop-blocks .cart-tik").length},this.select={all:function(){var r=this,t=i("#W-cart-footer").find(".cart-tik");t.hasClass("on")||t.addClass("on"),i(".shop-blocks").each(function(t,o){var e=i(this);r.shop(e.attr("data-shop-code"))})},shop:function(t){if(!t)return!1;i(".shop-blocks[data-shop-code="+t+"]").find(".cart-tik").addClass("on")}},this.unSelect={all:function(){var r=this,t=i("#W-cart-footer").find(".cart-tik");t.hasClass("on")&&t.removeClass("on"),i(".shop-blocks").each(function(t,o){var e=i(this);r.shop(e.attr("data-shop-code"))})},shop:function(t){if(!t)return!1;i(".shop-blocks[data-shop-code="+t+"]").find(".cart-tik").removeClass("on")},shopTitle:function(t){if(!t)return!1;i(".shop-blocks[data-shop-code="+t+"]").find(".shop-title .cart-tik").removeClass("on")},footerTitle:function(){i("#W-cart-footer").find(".cart-tik").removeClass("on")}}}function e(){this.get=function(o){function e(){i.ajax({type:"post",url:"/cart/getGoods",dataType:"json",beforeSend:function(){mui.toast("loading",{duration:1e8,type:"div"})},data:{unloginCartList:t},success:function(t){mui.wCloseAllToasts(),o&&o(t)},error:function(t){}})}var t;if(t=wb.cart.getInfoFromStorage("array"),0===wb.isLogin&&t.length<=0)return!1;0===wb.isLogin?e():1===wb.isLogin&&(t.length&&0<t.length?i.ajax({type:"post",url:"/cart/mergeToLoginCart",dataType:"json",beforeSend:function(){mui.toast("loading",{duration:1e8,type:"div"})},data:{unloginCartList:t},success:function(t){try{if(403===t.info.error)return window.location.href="/member/login/?referrer="+location.pathname,!1}catch(t){}localStorage.removeItem("cart"),e()},error:function(t){}}):e())},this.updateQuantity=function(t,o){if(t&&t.quantity&&isNaN(Number(t.quantity)))return!1;var e,r,a=wb.extend({goodsCode:null,cartId:null,quantity:null},t);0===wb.isLogin?(e=wb.cart.setInfoToStorage(a.goodsCode,{quantity:a.quantity,cart:a.cartId}),r=[],i(e).each(function(t,o){r.push({goodsCode:t,quantity:o.quantity,salePrice:o.salePrice})}),wb.cart.goods.updateSubQuantity(a.goodsCode,{quantity:a.quantity}),wb.cart.goods.updateStatus()):1===wb.isLogin&&i.ajax({type:"post",url:"/cart/updateQuantity",dataType:"json",beforeSend:function(){mui.toast("loading",{duration:1e8,type:"div"})},data:{cartId:a.cartId,quantity:a.quantity},success:o,error:function(t){}})},this.updateStatus=function(){function o(){var t=e.getInvalidGoods();0===e.getAvailableGoods().length&&0===t.length&&wb.cart.emptyTips.show()}var e=this,t=this.getSelected();0===t.length&&(wb.cart.unSelect.all(),wb.cart.footer.deleteBtn.grey()),0<t.length?(i.ajax({type:"POST",url:"/cart/getStatus",dataType:"json",beforeSend:function(){mui.toast("loading",{duration:1e8,type:"div"})},data:{calcItemModelList:t},success:function(t){mui.wCloseAllToasts();try{if(403===t.info.error)return!(location.href="/member/login?referrer=/cart")}catch(t){}wb.cart.footer.prices(t.data.prices),wb.cart.footer.submitBtn.val(t.data.length),o()},error:function(t){}}),wb.cart.footer.deleteBtn.red()):(wb.cart.footer.prices({goodsAmount:0,payableAmount:0,totalDiscount:0}),wb.cart.footer.submitBtn.val(0),o())},this.delete=function(t,o){function e(){wb.cart.scrolls[o].destroy(),wb.cart.scrolls[o]=null,delete wb.cart.scrolls[o],1===a.children(".goods").children(".lines").length?a.remove():r.remove()}var r=i(".shop-blocks").find(".lines[data-goods-code="+o+"]"),a=r.parents(".shop-blocks");if(0===wb.isLogin){if(!wb.cart.removeGoodsFromStorage(o))return!1;e()}else 1===wb.isLogin&&i.ajax({type:"post",url:"/cart/delete",dataType:"json",data:{cartId:t},beforeSend:function(){mui.toast("loading",{duration:1e8,type:"div"})},success:function(t){if(0<t.info.error)return mui.wCloseAllToasts(),403===t.info.error?location.href="/member/login?referrer=/cart":mui.toast(t.info.message||"网络错误",{duration:2e3,type:"div"}),!1;mui.wCloseAllToasts(),e(),wb.cart.goods.updateStatus()},error:function(t){}})},this.addToCollect=function(t,o){if(0===wb.isLogin)return mui.confirm("","登录才能收藏，现在登录？",["否","是"],function(t){1===t.index&&(window.location.href="/member/login/?referrer="+location.pathname)}),!1;i.ajax({type:"post",url:"/cart/addToCollect",dataType:"json",data:{cartId:t},beforeSend:function(){mui.toast("loading",{duration:1e8,type:"div"})},success:function(t){mui.wCloseAllToasts(),0===t.info.error?(mui.toast("收藏成功",{duration:1e3,type:"div"}),wb.cart.goods.removeDomByGoodsCode(o),wb.cart.goods.updateStatus()):403===t.info.error&&mui.confirm("","登录才能收藏，现在登录？",["否","是"],function(t){1===t.index&&(window.location.href="/member/login/?referrer="+location.pathname)})},error:function(t){}})},this.getSelected=function(){var t=i("#W-cart").children(".cart-content").children(".shop-blocks").children(".goods").children(".lines"),a=[];return t.each(function(t,o){var e=i(this);if(e.children(".slide-wrap").find(".cart-tik").hasClass("on")){var r={};0<e.children(".activity").length?r.activityCode=Number(e.children(".activity").attr("data-activity-code")):r.activityCode=0,r.quantity=Number(e.find("span.quatity").children("span").text())||0,a.push(i.extend(r,{goodsCode:Number(e.attr("data-goods-code")),cartId:Number(e.attr("data-cart-id")),isPresell:"2"===e.find(".inner .desc .presellBadge[data-sale-type]").attr("data-sale-type")}))}}),a},this.getAvailableGoods=function(){var t=i("#W-cart").children(".cart-content").children(".shop-blocks").children(".goods").children(".lines"),r=[];return t.each(function(t,o){var e=i(this);r.push({goodsCode:Number(e.attr("data-goods-code")),cartId:Number(e.attr("data-cart-id")),goodsName:i.trim(e.find(".desc .words").text()),wbiaoPrice:Number(e.find(".price .wbiaoPrice").text().replace(/,/gi,"")),quantity:Number(e.find(".bottom .quatity").children("span").text())})}),r},this.getInvalidGoods=function(){var t=i("#invalidGoods").children(".lines"),r=[];return t.each(function(t,o){var e=i(this);r.push({goodsCode:Number(e.attr("data-goods-code")),cartId:Number(e.attr("data-cart-id"))})}),r},this.getGoodsByShopCode=function(t){if(!t||isNaN(Number(t)))return!1;var o=i(".shop-blocks[data-shop-code="+t+"]").children(".goods").children(".lines"),r=[];return o.each(function(t,o){var e=i(this);r.push({goodsCode:Number(e.attr("data-goods-code")),cartId:Number(e.attr("data-cart-id"))})}),r},this.batchDelete=function(){var t,e=this.getSelected(),o=[];for(t in e)o.push(e[t].cartId);if(0===o.length)return!1;0===wb.isLogin?function(){var t;for(t in e)wb.cart.goods.removeDomByGoodsCode(e[t].goodsCode),wb.cart.removeGoodsFromStorage(e[t].goodsCode)}():1===wb.isLogin&&i.ajax({type:"post",url:"/cart/batchDelete",dataType:"json",data:{cartIdList:o},beforeSend:function(){mui.toast("loading",{duration:1e8,type:"div"})},success:function(t){var o;if(mui.wCloseAllToasts(),0===t.info.error){for(o in mui.toast("批量删除成功",{duration:1e3,type:"div"}),e)wb.cart.goods.removeDomByGoodsCode(e[o].goodsCode);wb.cart.goods.updateStatus()}else 403===t.info.error&&mui.toast("请先登录",{duration:1e3,type:"div"})},error:function(t){}})},this.batchAddToCollect=function(){var o,e=this.getSelected(),t=[];for(o in e)t.push(e[o].cartId);if(0===t.length)return!1;i.ajax({type:"post",url:"/cart/batchAddToCollect",dataType:"json",data:{cartIdList:t},beforeSend:function(){mui.toast("loading",{duration:1e8,type:"div"})},success:function(t){if(mui.wCloseAllToasts(),0===t.info.error)for(o in mui.toast("收藏成功",{duration:1e3,type:"div"}),e)wb.cart.goods.removeDomByGoodsCode(e[o].goodsCode);else 403===t.info.error&&mui.confirm("","登录才能收藏，现在登录？",["否","是"],function(t){1===t.index&&(window.location.href="/member/login/?referrer="+location.pathname)})},error:function(t){}})},this.batchDeleteInvalidGoods=function(){var t,o=this.getInvalidGoods(),e=[];for(t in o)e.push(o[t].cartId);if(0===e.length)return!1;0===wb.isLogin?function(){var t;for(t in o)wb.cart.removeGoodsFromStorage(o[t].goodsCode)}():1===wb.isLogin&&i.ajax({type:"post",url:"/cart/batchDelete",dataType:"json",data:{cartIdList:e},beforeSend:function(){mui.toast("loading",{duration:1e8,type:"div"})},success:function(t){mui.wCloseAllToasts(),0===t.info.error?(mui.toast("清空失效商品成功",{duration:1e3,type:"div"}),i("#invalidGoods").remove()):403===t.info.error?mui.toast("请先登录",{duration:1e3,type:"div"}):mui.toast(t.info.message||"网络错误",{duration:1e3,type:"div"})},error:function(t){}})},this.removeDomByGoodsCode=function(t){var o=i(".shop-blocks").find(".lines[data-goods-code="+t+"]"),e=o.parents(".shop-blocks");wb.cart.scrolls[t].destroy(),wb.cart.scrolls[t]=null,delete wb.cart.scrolls[t],1===e.children(".goods").children(".lines").length?e.remove():o.remove()},this.updateSubQuantity=function(t,o){i(".lines[data-goods-code="+t+"]").find(".bottom").children(".quatity").children("span").text(o.quantity)}}function r(){var t=["normal","editing"],o=t[0];this.hide=function(){i("#W-cart-footer").children(".footer-bar.footer-bar-normal").addClass("h")},this.show=function(){i("#W-cart-footer").children(".footer-bar.footer-bar-normal").removeClass("h")},this.submitBtn={val:function(t){return"number"==typeof t&&(t?void i("#W-cart-footer .submit-btn").text("结算("+t+")"):(i("#W-cart-footer .submit-btn").text("结算"),t))},submit:function(){var t,o=wb.cart.goods.getSelected(),e=!1;if(0===o.length)return mui.toast("请选择商品",{duration:1500}),!1;if(1<o.length){for(t in o)if(o[t].isPresell){e=!0;break}if(e)return mui.toast("商品中包含预售商品，请把预售商品单独提交结算！",{duration:2e3}),!1}i.cookie("order_confirm",JSON.stringify(o),{expires:86400,path:"/"}),window.location.href="/order/confirm"}},this.deleteBtn={red:function(){i("#W-cart-footer").find(".edit-btns .delete-btn").addClass("on")},grey:function(){i("#W-cart-footer").find(".edit-btns .delete-btn").removeClass("on")}},this.prices=function(t){var o=i.extend({goodsAmount:null,totalDiscount:null,payableAmount:null},t),e=i("#W-cart-footer .detail").children("p");e.children("#payableAmount").text(o.payableAmount||0),e.children("#goodsAmount").text(o.goodsAmount||0),o.totalDiscount?e.find("#totalDiscount").text(o.totalDiscount).parent("span").removeClass("h"):e.find("#totalDiscount").parent("span").addClass("h")},this.switchToEditMode=function(){return o!==t[1]&&(o=t[1],i("#W-cart-footer").children(".footer-bar.footer-bar-normal").addClass("h"),i("#W-cart-footer").children(".footer-bar.footer-bar-editing").removeClass("h"),!0)},this.switchToNormalMode=function(){if(o===t[0])return!1;o=t[0],i("#W-cart-footer").children(".footer-bar.footer-bar-editing").addClass("h"),i("#W-cart-footer").children(".footer-bar.footer-bar-normal").removeClass("h")}}function a(){this.editAllBtn={hide:function(){i("#w-editAll").addClass("h")},show:function(){i("#w-editAll").removeClass("h")}},this.loginTips={hide:function(){i("#W-cart-head").children(".login-tips").addClass("h"),i("#W-cart").removeClass("paddingTop80")},show:function(){i("#W-cart-head").children(".login-tips").removeClass("h"),i("#W-cart").addClass("paddingTop80")}}}var n={data:null,getActivitiesByGoodsCode:function(t){if(!this.data||!t)return!1;var o,e,r={list:[]},a=this.data.cartShopList;for(o in a){if(0<r.list.length)break;for(e in a[o].cartGoodsList)if(Number(t)===a[o].cartGoodsList[e].goodsCode){i.extend(r,{selectedActivityCode:a[o].cartGoodsList[e].activityCode,selectedActivityName:a[o].cartGoodsList[e].activityName,selectedActivityTypeName:a[o].cartGoodsList[e].selectedActivityTypeName,list:a[o].cartGoodsList[e].activityList});break}}return r}};i(function(){wb.extend(wb,{cart:{getInfoFromStorage:function(t){if(!t)return i.parseJSON(localStorage.getItem("cart"));var o,e=0,r=i.parseJSON(localStorage.getItem("cart")),a=[];if("quantity"!==t)return"array"===t?(i.each(r,function(t,o){a.push({goodsCode:t,quantity:o.quantity,salePrice:o.salePrice})}),a):"number"==typeof t?r[String(t)]:null;for(o in r)e+=r[o].quantity;return e},setInfoToStorage:function(t,o){var e=this.getInfoFromStorage();return e[String(t)]?(i.extend(e[String(t)],o||{}),localStorage.setItem("cart",JSON.stringify(e))):e[String(t)]=o||{},this.getInfoFromStorage()},removeGoodsFromStorage:function(t){var o=this.getInfoFromStorage();return!!o[String(t)]&&(delete o[String(t)],localStorage.setItem("cart",JSON.stringify(o)),!0)},getCouponByShopCode:function(t,o){if(!t||isNaN(Number(t)))return!1;var e,r=wb.cart.goods.getGoodsByShopCode(t),a=[];if(0<r.length)for(e in r)a.push(r[e].goodsCode);i.ajax({type:"POST",url:"/cart/getMutiGoodsCouponList",dataType:"json",data:{goodsCodes:a,siteRange:3},beforeSend:function(){mui.toast("loading",{duration:1e8,type:"div"})},success:function(t){o&&o(t)},error:function(t){}})},emptyTips:{show:function(){i("#W-cart").children(".empty-status").removeClass("h"),wb.cart.header.editAllBtn.hide()},hide:function(){i("#W-cart").children(".empty-status").addClass("h"),wb.cart.header.editAllBtn.show()}}},errorTips:function(t,o){var e=i.extend({403:null},o);return 403===t.info.error?(e[403]?e[403]():window.location.href="/member/login?referrer="+location.pathname+location.search,!1):400===t.info.error?(mui.toast(t.info.message||"网络错误",{duration:2e3}),!1):500===t.info.error?(mui.toast("服务异常，请稍后再试",{duration:2e3}),!1):404===t.info.error?(mui.toast("网络异常，请稍后再试",{duration:2e3}),!1):void 0}}),wb.extend(wb.cart,new o,{goods:new e,footer:new r,header:new a}),wb.extend(wb,{gnFooter:new wb.GnFooter}),0===wb.isLogin&&wb.cart.header.loginTips.show(),0!==wb.isLogin||wb.cart.getInfoFromStorage()||wb.cart.emptyTips.show(),wb.cart.goods.get(function(t){if(0<t.info.error)return!1;if(!t.data.data)return mui.wCloseAllToasts(),mui.toast("网络错误，请稍后再试"),!1;var e,o=i("#cart-goods-temp").html().replace(/<%/g,"{{").replace(/%>/g,"}}"),r=Handlebars.compile(o);wb.extend(n,{data:t.data.data}),i("#W-cart").children(".cart-content").html(r(t.data)),0<t.data.data.cartShopList.length&&(wb.cart.header.editAllBtn.show(),wb.cart.footer.show()),0===t.data.length&&0===t.data.data.invalidGoodsList.length&&wb.cart.emptyTips.show(),e={},i(".slide-wrap").each(function(t){var o=i(this).parent(".lines").attr("data-goods-code");e[o]=new IScroll(i(this).get(0),{tap:!0,scrollX:!0,scrollY:!1,mouseWheel:!1,disableTouch:!1,eventPassthrough:!0}),e[o].on("scrollEnd",function(){return 0!==this.x&&this.x!==this.maxScrollX&&(this.x>this.maxScrollX/2?(this.scrollTo(0,0,200,IScroll.utils.ease.quadratic),!1):void((this.x<=this.maxScrollX/2||this.x>this.maxScrollX)&&this.scrollTo(-120,0,200,IScroll.utils.ease.quadratic)))})}),wb.extend(wb.cart,{scrolls:e}),wb.gnFooter.cartBadgeVal(t.data.length),function(t,o){var e,r=window.wb.cart.goods.getAvailableGoods(),a=[];for(e in r)a.push({id:r[e].goodsCode,vendorId:"",name:r[e].goodsName,price:r[e].wbiaoPrice,quantity:r[e].quantity});t[o]="function"==typeof t[o]?t[o]:function(){(t[o].c=t[o].c||[]).push(arguments)},_qha("send",{et:32,goods:a})}(window,"_qha")}),i("#W-popUpPanel-coupon").on("click",".wb_back",function(){mui("#W-popUpPanel-coupon").popover("hide")}).on("click",".coupons-inner",function(){var e=Number(i(this).attr("data-coupon-code"));0===wb.isLogin?window.location.href="/member/login?referrer="+location.pathname+location.search:1===wb.isLogin&&i.ajax({type:"POST",url:"/goods/front/receive",dataType:"json",data:{couponCode:e,siteRange:3},beforeSend:function(){mui.toast("loading",{duration:1e8,type:"div"})},success:function(t){mui.wCloseAllToasts();var o=i("#W-popUpPanel-coupon").find("[data-coupon-code="+e+"]");return o.hasClass("grey")?(mui.toast("你已领取，请到个人中心-我的优惠券查看",{duration:1500,type:"div"}),!1):0<t.info.error?(403===t.info.error?window.location.href="/member/login?referrer="+location.href:mui.toast(t.info.error||"网络错误",{duration:1500,type:"div"}),!1):(mui.toast("领取成功",{duration:1500,type:"div"}),o.removeClass("brown").addClass("grey"),void o.find(".gotedStatus").text("已经领取"))},error:function(t){}})}),i("#W-panel-off").on("click",".wb_back",function(){mui("#W-panel-off").popover("hide")}),i("#W-cart").on("click",".shop-blocks .shop-title .tips-r",function(){var t=i(this).parents(".shop-blocks[data-shop-code]").attr("data-shop-code");wb.cart.getCouponByShopCode(Number(t),function(t){if(mui.wCloseAllToasts(),0<t.info.error)return 403===t.info.error&&mui.confirm("","登录才能，现在登录？",["否","是"],function(t){1===t.index&&(window.location.href="/member/login/?referrer="+location.pathname)}),500===t.info.error&&mui.toast("服务异常，请稍后再试",{duration:1500,type:"div"}),404===t.info.error&&mui.toast("网络异常，请稍后再试",{duration:1500,type:"div"}),400===t.info.error&&mui.toast(t.info.message||"网络异常，请稍后再试",{duration:1500,type:"div"}),!1;if(0===t.data.length)return mui.toast("该店铺无可用券",{duration:1500,type:"div"}),!1;var o=i("#coupons-template").html().replace(/<%/g,"{{").replace(/%>/g,"}}"),e=Handlebars.compile(o);0===t.info.error&&i("#W-popUpPanel-coupon").find(".coupons").html(e(t)),mui("#W-popUpPanel-coupon").popover("show"),window.setTimeout(function(){document.querySelector("#W-popUpPanel-coupon").removeEventListener(mui.EVENT_MOVE,mui.preventDefault)},500)})}).on("click",".activity .act-more-btn",function(){var t=i(this).parents(".lines").attr("data-goods-code"),o=n.getActivitiesByGoodsCode(Number(t));i(o.list).each(function(t,o){var e=i("#W-panel-off").find(".content"),r=e.children(".lines.h").clone();r.children("p").text(o.activityName),r.attr("data-act-code",o.activityCode),e.append(r.removeClass("h")),e.children(".lines.h").remove(),e.children(".lines").eq(0).addClass("on")}),mui("#W-panel-off").popover("show")}).on("click",".goods-tips .more-btn",function(){mui("#W-panel-off").popover("show")}).on("click",".shop-title .cart-tik",function(){var t=i(this).parents(".shop-blocks").attr("data-shop-code");i(this).hasClass("on")?wb.cart.unSelect.shop(t):wb.cart.select.shop(t),wb.cart.isSelectedAll()?wb.cart.select.all():wb.cart.unSelect.footerTitle(),wb.cart.goods.updateStatus()}).on("click",".goods .cart-tik",function(){var t=i(this),o=t.parents(".shop-blocks").attr("data-shop-code");t.toggleClass("on"),wb.cart.isShopSelectedAll(o)?wb.cart.select.shop(o):wb.cart.unSelect.shopTitle(o),wb.cart.isSelectedAll()?wb.cart.select.all():wb.cart.unSelect.footerTitle(),wb.cart.goods.updateStatus()}).on("click",".lines .to-delete,.lines .del",function(t){var o=i(this).parents(".lines"),e=o.attr("data-goods-code"),r=o.attr("data-cart-id");wb.cart.goods.delete(r,e)}).on("click",".lines .to-collection",function(t){var o=i(this).parents(".lines"),e=o.attr("data-goods-code"),r=o.attr("data-cart-id");wb.cart.goods.addToCollect(r,e)}).on("click",".editor .calc-btns",function(t){t.stopPropagation(),t.preventDefault();var o=i(this),e=o.siblings(".val"),r=parseInt(e.text()),a=Number(o.parents("[data-goods-code]").attr("data-goods-code"));if(o.hasClass("plus"))++r;else if(o.hasClass("minus")){if(1===r)return!1;--r}wb.cart.goods.updateQuantity({cartId:Number(o.parents("[data-cart-id]").attr("data-cart-id")),quantity:r,goodsCode:a},function(t){if(mui.wCloseAllToasts(),0===t.info.error)e.text(r),wb.cart.footer.prices(t.data.prices),wb.cart.goods.updateSubQuantity(a,{quantity:r}),wb.cart.goods.updateStatus();else{if(403===t.info.error)return!(location.href="/member/login?referrer=/cart");mui.toast(t.info.message||"网络错误",{duration:1500,type:"div"})}})}).on("click","#clearInvalidGoodsBtn",function(){wb.cart.goods.batchDeleteInvalidGoods()}),i("#W-panel-off").on("click",".content .lines",function(){var t=i(this);t.siblings().removeClass("on"),t.addClass("on")}),i("#w-editAll").on("click",function(t){i(this).addClass("h"),i(this).siblings("#w-editFinish").removeClass("h"),wb.cart.footer.switchToEditMode(),wb.cart.editAll()}),i("#w-editFinish").on("click",function(t){i(this).addClass("h"),i(this).siblings("#w-editAll").removeClass("h"),wb.cart.footer.switchToNormalMode(),wb.cart.editAllCancel()}),i("#W-cart-footer").on("click",".cart-tik",function(){var t;i(this).hasClass("on")?wb.cart.unSelect.all():wb.cart.select.all(),"number"==typeof(t=wb.cart.goods.getSelected().length)&&wb.cart.footer.submitBtn.val(t),wb.cart.goods.updateStatus()}).on("click","#batch-delete-btn",function(){wb.cart.goods.batchDelete()}).on("click","#batch-collect-btn",function(){1===wb.isLogin?wb.cart.goods.batchAddToCollect():mui.confirm("","登录才能收藏，现在登录？",["否","是"],function(t){1===t.index&&(window.location.href="/member/login/?referrer="+location.pathname)})}).on("click",".submit-btn",function(){wb.cart.footer.submitBtn.submit()}),i.cookie("order_confirm")&&i.removeCookie("order_confirm",{path:"/"}),i.cookie("order_group")&&i.removeCookie("order_group",{path:"/"}),i.cookie("isUseCoupon")&&i.removeCookie("isUseCoupon",{path:"/"}),i.cookie("invoice_info")&&i.removeCookie("invoice_info",{path:"/order"})})}(window,jQuery);