var detailJS={setHeight:function(){$(window).height(),$(".headOut").height(),$(".footOuter").height()},headTabs:function(){var t=!0,e=this.sendAjax;headSwiper=new Swiper("#tabs-container",{paginationClickable:!0,observer:!0,observeParents:!0,autoHeight:!0,noSwiping:!0,noSwipingClass:"stop-swiping",speed:500,on:{slideChangeTransitionStart:function(){$(".tabs .on").removeClass("on"),$(".tabs a").eq(this.activeIndex).addClass("on")},slideChangeTransitionEnd:function(){$(".W_title .wb_goods_tab a").eq(2).hasClass("on")&&t&&(t=!1,e("#evaluate_total_content"))}},observeSlideChildren:!0}),$(".tabs a").on("click",function(t){t.preventDefault(),$(".tabs .on").removeClass("on"),$(this).addClass("on"),headSwiper.slideTo($(this).parent().index())})},swipers:function(){new Swiper(".swiper-container-carousel",{visibilityFullFit:!0,loop:!0,lazy:!0,pagination:{el:".pr_carousel .swiper-pagination"}})},detailsTab:function(){$(".details .W_gnTab_nav ul").on("click","li",function(){$(this).addClass("on").siblings().removeClass("on"),$("#details_content").find(".gnTabs_block").eq($(this).index()).show().siblings().hide(),headSwiper.update()})},storeTab:function(){$(".store .store-content li").last().addClass("h"),$(".store-title").on("click","li",function(){$(this).addClass("on").siblings().removeClass("on"),$(".store-content").find("li").eq($(this).index()).removeClass("h").siblings().addClass("h"),headSwiper.update()})},evaluateTab:function(){var t=!0,e=this.sendAjax,a=this.evaluateMock;$(".evaluate .W_gnTab_nav ul").on("click","li",function(){$(this).addClass("on").siblings().removeClass("on"),$("#evaluate_content").find(".gnTabs_block").eq($(this).index()).removeClass("h").siblings().addClass("h"),$(".evaluate .W_gnTab_nav ul li").eq(1).hasClass("on")&&t&&(a(!(t=!1)),e("#evaluate_total_content2"))})},productAllEval:function(){$(".evaluate_more_whole").on("click",function(){headSwiper.slideTo(2,300,!1),headSwiper.update()})},evaluateMock:function(t){var e=this.sendAjax,a=[0,"images/detail/evaluate-head-01 (1).jpg","images/detail/evaluate-head-01 (3).jpg","images/detail/evaluate-head-01 (2).jpg","images/detail/evaluate-head-01 (4).jpg","images/detail/evaluate-head-01 (5).jpg"];t&&a.shift();Mock.mock("http://evaluate.com",{err:0,"list|8":[{"head|1":a,name:/^\w{2}[*]{4}\w{2}$/,"vip|0-2":1,"wuxing|1-5":1,"txt|1":["万表买的第二块表，都不错，除了厚一点","好看，走时准，一天大概快两三。","说实话第一眼看到给我的感觉很有档次，做工没的说，至于其他的等我用过一段时间后在做评价"],img:function(){var t,e,a=[];e=Math.floor(7*Math.random());for(var i=0;i<e;i++)t=Math.floor(17*Math.random()),a.push("images/detail/evaluateMock-01 ("+t+").jpg");return a},date:Mock.Random.datetime(),"style|0-1":"真皮 白色 牛皮",imgNum:"共3张图"}]}),$(".W_gnTab_content .detail_more").eq(0).on("click",function(){e("#evaluate_total_content")}),$(".W_gnTab_content .detail_more").eq(1).on("click",function(){e("#evaluate_total_content2")})},productEval:function(){this.sendAjax(".pr_evaluate .evaluate_content","single","headtab")},sendAjax:function(i,n,o){var s=this.headTabs;$.ajax({url:"http://evaluate.com",dataType:"json",success:function(t){if("single"==n){var e=[];e.push(t.list[0]),t.list=e}var a;a="",a+=ejs.render(document.getElementById("evaluateMock").innerHTML,{evaluate:t}),a+=$(i).html(),$(i).html(a),o&&s.call(detailJS),headSwiper.update()}})},eject:function(t,e,a){$(t).on("click",function(){$(a).fadeIn(),$(".tc_content").addClass("tc_bottom"),$("body").css({overflow:"hidden"})}),$(e).on("click",function(){$(a).fadeOut(),$(".tc_content").removeClass("tc_bottom"),$("body").css({overflow:"auto"})})},ejectAll:function(){var t=this.eject;t(".coupons_stages",".tc_button_b,.tc_bg",".tc_container_fq"),t(".coupons_voucher",".tc_button_b,.tc_bg",".tc_container_juan"),t(".coupons_promotion",".tc_button_b,.tc_bg",".tc_container_cx"),t(".flaw",".tc_button_b,.tc_bg",".tc_container_xc"),t(".ys_content",".tc_button_b,.tc_bg",".tc_container_ys"),t(".pr_coice",".choice_content-a_ico,.tc_bg",".tc_container_choice"),t(".js_share",".fx_button,.tc_bg",".tc_container_fx"),t(".combination_ico",".js_combination,.tc_bg",".tc_container_zh"),t(".W_combination .more",".purchase_title,.icon-a-close03,.tc_bg",".tc_container_rq"),t("#brand",".tc_container_brand .button,.tc_container_brand .brandPopup .title i,.tc_bg",".tc_container_brand"),t(".rareClick",".tc_container_rare .tc_bg,.tc_container_rare .tc_button_b",".tc_container_rare"),$(".choice_content_b_content").find("span").on("click",function(){$(this).addClass("colour").siblings().removeClass("colour");0==$(this).index()?(console.log(1111),$(".choice_content-a_img img").attr({src:"https://image7.wbiao.co/shop/121382c5d7ee4bcfbdb3061eb3f0ca03.jpg?x-oss-process=image/resize,m_pad,w_750,h_750,color_ffffff"})):1==$(this).index()?$(".choice_content-a_img img").attr({src:"https://image7.wbiao.co/shop/5c5921ea1d0b479bbd13dbf8ca0e0404.jpg?x-oss-process=image/resize,m_pad,w_750,h_750,color_ffffff"}):$(".choice_content-a_img img").attr({src:"https://image7.wbiao.co/shop/0c2f546fff5b4180b93ce3a4f4f40e3f.jpg?x-oss-process=image/resize,m_pad,w_750,h_750,color_ffffff"})})},add:function(){var e,a=$("#count"),i=Number(a.attr("data-realCount"))+Number(a.attr("data-virtualCount"));$(".choice_content_b_num_b").find("span").on("click",function(){var t=$(this);if(e=Math.floor(a.val()),"add"==t.attr("data-type")){if(5===Number(t.attr("data-saleType")))return!1;i<=e?a.val(i):(a.val(++e),t.siblings("span").removeClass("boder_colour"))}else 1<e&&(2==e&&t.addClass("boder_colour"),a.val(--e))})},heart:function(){var t=this.isLogin;$(".detail_footer_ico3").on("click",function(){t()?$(this).hasClass("icon-d-goods-xin2")?($("body").append("<div class='mui-toast-container'><div class='mui-toast-message'>取消成功</div>"),$(".mui-toast-container").addClass("mui-active"),$(".mui-toast-container")[0].addEventListener("webkitTransitionEnd",function(){$(".mui-toast-container").hasClass("mui-active")||$(".mui-toast-container").remove()}),setTimeout(function(){$(".mui-toast-container")&&$(".mui-toast-container").removeClass("mui-active")},1e3),$(".detail_footer_ico3").removeClass("icon-d-goods-xin2")):($("body").append("<div class='mui-toast-container'><div class='mui-toast-message'>收藏成功</div>"),$(".mui-toast-container").addClass("mui-active"),$(".mui-toast-container")[0].addEventListener("webkitTransitionEnd",function(){$(".mui-toast-container").hasClass("mui-active")||$(".mui-toast-container").remove()}),setTimeout(function(){$(".mui-toast-container")&&$(".mui-toast-container").removeClass("mui-active")},1e3),$(".detail_footer_ico3").addClass("icon-d-goods-xin2")):location.href="login.html"})},isLogin:function(){return!!getCookie("user")},title:function(){$(".wb_more").on("click",function(){$(".ol_show").toggleClass("h")}),$(window).scroll(function(){50<=$(window).scrollTop()&&$(".ol_show").addClass("h")})},removeByValue:function(t,e){for(var a=0;a<t.length;a++)if(t[a]==e){t.splice(a,1);break}},popularity:function(){var v=this,t=$(".purchase_cont"),g=t.find("li"),C=[],w=[],x=[],k=[],T=t.find("li").eq(0).find(".sp2").children("b").html();t.on("click","li span.icon-a-mj_yixuan",function(){var t=$(this);if(t.hasClass("icon-a-white-tik")){t.removeClass("icon-a-white-tik");for(var e=1;e<g.length;e++)if(!g.eq(e).find("span.choose").hasClass("icon-a-white-tik")){var a,i,n=[],o=[];i={value:e,text:g.eq(e).find("span.sp2").children("b").html()},a={value:e,text:g.eq(e).find("p.p1 span").children("em").html()},n.push(i),o.push(a);for(var s=0;s<n.length;s++)-1==w.indexOf(n[s].value)&&(w.push(n[s].value),C.push(n[s].text));for(s=0;s<o.length;s++)-1==x.indexOf(o[s].value)&&(x.push(n[s].value),k.push(o[s].text))}for(var c=Number(T),l=0,r=0;r<C.length;r++)c+=Number(C[r]);for(var d=0;d<k.length;d++)l+=Number(k[d]);v.CartFooter(c,l)}else{t.addClass("icon-a-white-tik");var u=t.siblings("a").find("p.p2").find("span.sp2").children("b").html(),h=t.siblings("a").find("p.p1").find("span").children("em").html(),_=t.parents("li").index();v.removeByValue(C,u),v.removeByValue(w,_),v.removeByValue(k,h),v.removeByValue(x,_);var f=Number(T),p=0;if(C.length<1)f=0;else{for(var b=0;b<C.length;b++)f+=Number(C[b]);for(var m=0;m<k.length;m++)p+=Number(k[m])}v.CartFooter(f,p)}})},CartFooter:function(t,e){var a=$(".purchase_footer");a.children(".sp1").find("em").text(t||0),a.children(".sp2").find("em").text(e||0)},getGoods:function(){var t=location.href.split("=")[1];$.ajax({type:"get",url:"api/dmDetail.php",dataType:"json",data:{goodsCode:t},success:function(t){console.log(t),t.error||($(".choice_content-a_title_bian").attr("data-index",t.detail[0].Id),$(".wbPrice").text(t.detail[0].price),$(".title_b.share_text").text(t.detail[0].details),$(".choice_content-a_title_bian").find("span").text(t.detail[0].Id))}})},init:function(){this.getGoods(),this.swipers(),this.detailsTab(),this.storeTab(),this.evaluateTab(),this.evaluateMock(),this.productEval(),this.setHeight(),this.ejectAll(),this.add(),this.heart(),this.title(),this.popularity(),this.productAllEval()}};detailJS.init();